<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Go on DamonZhangğŸ”¥</title>
    <link>https://damon-zhangb.github.io/tags/go/</link>
    <description>Recent content in Go on DamonZhangğŸ”¥</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh</language>
    <copyright>&amp;copy; 2021 &lt;a href=&#34;https://github.com/Damon-Zhangb&#34;&gt;Damon.Zhang&lt;/a&gt;
</copyright>
    <lastBuildDate>Thu, 04 Nov 2021 09:30:18 +0800</lastBuildDate><atom:link href="https://damon-zhangb.github.io/tags/go/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Go æ¯æ—¥ä¸€åº“ä¹‹ cron</title>
      <link>https://damon-zhangb.github.io/posts/go-%E6%AF%8F%E6%97%A5%E4%B8%80%E5%BA%93%E4%B9%8B-cron/</link>
      <pubDate>Thu, 04 Nov 2021 09:30:18 +0800</pubDate>
      
      <guid>https://damon-zhangb.github.io/posts/go-%E6%AF%8F%E6%97%A5%E4%B8%80%E5%BA%93%E4%B9%8B-cron/</guid>
      <description>ç®€ä»‹ cronä¸€ä¸ªç”¨äºç®¡ç†å®šæ—¶ä»»åŠ¡çš„åº“ï¼Œç”¨ Go å®ç° Linux ä¸­crontabè¿™ä¸ªå‘½ä»¤çš„æ•ˆæœã€‚
HelloWorld å®‰è£…cronï¼Œç›®å‰æœ€æ–°ç¨³å®šç‰ˆæœ¬ä¸º v3ï¼š
$ go get -u github.com/robfig/cron/v3  ä½¿ç”¨ï¼š
package main import ( &amp;quot;fmt&amp;quot; &amp;quot;time&amp;quot; &amp;quot;github.com/robfig/cron/v3&amp;quot; ) func main() { c := cron.New() c.AddFunc(&amp;quot;@every 1s&amp;quot;, func() { fmt.Println(&amp;quot;tick every 1 second&amp;quot;) }) c.Start() time.Sleep(time.Second * 5) }  ä½¿ç”¨éå¸¸ç®€å•ï¼Œåˆ›å»ºcronå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ç”¨äºç®¡ç†å®šæ—¶ä»»åŠ¡ã€‚
è°ƒç”¨cronå¯¹è±¡çš„AddFunc()æ–¹æ³•å‘ç®¡ç†å™¨ä¸­æ·»åŠ å®šæ—¶ä»»åŠ¡ã€‚AddFunc()æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œå‚æ•° 1 ä»¥å­—ç¬¦ä¸²å½¢å¼æŒ‡å®šè§¦å‘æ—¶é—´è§„åˆ™ï¼Œå‚æ•° 2 æ˜¯ä¸€ä¸ªæ— å‚çš„å‡½æ•°ï¼Œæ¯æ¬¡è§¦å‘æ—¶è°ƒç”¨ã€‚@every 1sè¡¨ç¤ºæ¯ç§’è§¦å‘ä¸€æ¬¡ï¼Œ@everyååŠ ä¸€ä¸ªæ—¶é—´é—´éš”ï¼Œè¡¨ç¤ºæ¯éš”å¤šé•¿æ—¶é—´è§¦å‘ä¸€æ¬¡ã€‚ä¾‹å¦‚@every 1hè¡¨ç¤ºæ¯å°æ—¶è§¦å‘ä¸€æ¬¡ï¼Œ@every 1m2sè¡¨ç¤ºæ¯éš” 1 åˆ† 2 ç§’è§¦å‘ä¸€æ¬¡ã€‚time.ParseDuration()æ”¯æŒçš„æ ¼å¼éƒ½å¯ä»¥ç”¨åœ¨è¿™é‡Œã€‚
è°ƒç”¨c.Start()å¯åŠ¨å®šæ—¶å¾ªç¯ã€‚
æ³¨æ„ä¸€ç‚¹ï¼Œå› ä¸ºc.Start()å¯åŠ¨ä¸€ä¸ªæ–°çš„ goroutine åšå¾ªç¯æ£€æµ‹ï¼Œæˆ‘ä»¬åœ¨ä»£ç æœ€ååŠ äº†ä¸€è¡Œtime.Sleep(time.Second * 5)é˜²æ­¢ä¸» goroutine é€€å‡ºã€‚
è¿è¡Œæ•ˆæœï¼Œæ¯éš” 1s è¾“å‡ºä¸€è¡Œå­—ç¬¦ä¸²ï¼š
$ go run main.go tick every 1 second tick every 1 second tick every 1 second tick every 1 second tick every 1 second  æ—¶é—´æ ¼å¼ ä¸Linux ä¸­crontabå‘½ä»¤ç›¸ä¼¼ï¼Œcronåº“æ”¯æŒç”¨ 5 ä¸ªç©ºæ ¼åˆ†éš”çš„åŸŸæ¥è¡¨ç¤ºæ—¶é—´ã€‚è¿™ 5 ä¸ªåŸŸå«ä¹‰ä¾æ¬¡ä¸ºï¼š</description>
    </item>
    
    <item>
      <title>Go æ¯æ—¥ä¸€åº“ä¹‹ logrus</title>
      <link>https://damon-zhangb.github.io/posts/go-%E6%AF%8F%E6%97%A5%E4%B8%80%E5%BA%93%E4%B9%8B-logrus/</link>
      <pubDate>Thu, 04 Nov 2021 09:30:18 +0800</pubDate>
      
      <guid>https://damon-zhangb.github.io/posts/go-%E6%AF%8F%E6%97%A5%E4%B8%80%E5%BA%93%E4%B9%8B-logrus/</guid>
      <description>ç®€ä»‹ logåº“åªæä¾›äº†ä¸‰ç»„æ¥å£ï¼ŒåŠŸèƒ½è¿‡äºç®€å•äº†ã€‚ ä»Šå¤©ï¼Œæˆ‘ä»¬æ¥ä»‹ç»ä¸€ä¸ªæ—¥å¿—åº“ä¸­çš„â€œæ˜æ˜Ÿåº“â€â€”â€”logrusã€‚ logruså®Œå…¨å…¼å®¹æ ‡å‡†çš„logåº“ï¼Œè¿˜æ”¯æŒæ–‡æœ¬ã€JSON ä¸¤ç§æ—¥å¿—è¾“å‡ºæ ¼å¼ã€‚å¾ˆå¤šçŸ¥åçš„å¼€æºé¡¹ç›®éƒ½ä½¿ç”¨äº†è¿™ä¸ªåº“ï¼Œå¦‚å¤§åé¼é¼çš„ dockerã€‚
helloworld ç¬¬ä¸‰æ–¹åº“éœ€è¦å…ˆå®‰è£…ï¼š
$ go get github.com/sirupsen/logrus  åä½¿ç”¨ï¼š
package main import ( &amp;quot;github.com/sirupsen/logrus&amp;quot; ) func main() { logrus.SetLevel(logrus.TraceLevel) logrus.Trace(&amp;quot;trace msg&amp;quot;) logrus.Debug(&amp;quot;debug msg&amp;quot;) logrus.Info(&amp;quot;info msg&amp;quot;) logrus.Warn(&amp;quot;warn msg&amp;quot;) logrus.Error(&amp;quot;error msg&amp;quot;) logrus.Fatal(&amp;quot;fatal msg&amp;quot;) logrus.Panic(&amp;quot;panic msg&amp;quot;) }  logrusçš„ä½¿ç”¨éå¸¸ç®€å•ï¼Œä¸æ ‡å‡†åº“logç±»ä¼¼ã€‚logrusæ”¯æŒæ›´å¤šçš„æ—¥å¿—çº§åˆ«ï¼š
 Panicï¼šè®°å½•æ—¥å¿—ï¼Œç„¶åpanicã€‚ Fatalï¼šè‡´å‘½é”™è¯¯ï¼Œå‡ºç°é”™è¯¯æ—¶ç¨‹åºæ— æ³•æ­£å¸¸è¿è½¬ã€‚è¾“å‡ºæ—¥å¿—åï¼Œç¨‹åºé€€å‡ºï¼› Errorï¼šé”™è¯¯æ—¥å¿—ï¼Œéœ€è¦æŸ¥çœ‹åŸå› ï¼› Warnï¼šè­¦å‘Šä¿¡æ¯ï¼Œæé†’ç¨‹åºå‘˜æ³¨æ„ï¼› Infoï¼šå…³é”®æ“ä½œï¼Œæ ¸å¿ƒæµç¨‹çš„æ—¥å¿—ï¼› Debugï¼šä¸€èˆ¬ç¨‹åºä¸­è¾“å‡ºçš„è°ƒè¯•ä¿¡æ¯ï¼› Traceï¼šå¾ˆç»†ç²’åº¦çš„ä¿¡æ¯ï¼Œä¸€èˆ¬ç”¨ä¸åˆ°ï¼›  æ—¥å¿—çº§åˆ«ä»ä¸Šå‘ä¸‹ä¾æ¬¡å¢åŠ ï¼ŒTraceæœ€å¤§ï¼ŒPanicæœ€å°ã€‚logrusæœ‰ä¸€ä¸ªæ—¥å¿—çº§åˆ«ï¼Œé«˜äºè¿™ä¸ªçº§åˆ«çš„æ—¥å¿—ä¸ä¼šè¾“å‡ºã€‚ é»˜è®¤çš„çº§åˆ«ä¸ºInfoLevelã€‚æ‰€ä»¥ä¸ºäº†èƒ½çœ‹åˆ°Traceå’ŒDebugæ—¥å¿—ï¼Œæˆ‘ä»¬åœ¨mainå‡½æ•°ç¬¬ä¸€è¡Œè®¾ç½®æ—¥å¿—çº§åˆ«ä¸ºTraceLevelã€‚
å®šåˆ¶ è¾“å‡ºæ–‡ä»¶å è°ƒç”¨logrus.SetReportCaller(true)è®¾ç½®åœ¨è¾“å‡ºæ—¥å¿—ä¸­æ·»åŠ æ–‡ä»¶åå’Œæ–¹æ³•ä¿¡æ¯ï¼š
package main import ( &amp;quot;github.com/sirupsen/logrus&amp;quot; ) func main() { logrus.SetReportCaller(true) logrus.Info(&amp;quot;info msg&amp;quot;) }  è¾“å‡ºå¤šäº†ä¸¤ä¸ªå­—æ®µfileä¸ºè°ƒç”¨logrusç›¸å…³æ–¹æ³•çš„æ–‡ä»¶åï¼Œmethodä¸ºæ–¹æ³•åï¼š
$ go run main.go time=&amp;quot;2020-02-07T21:46:03+08:00&amp;quot; level=info msg=&amp;quot;info msg&amp;quot; func=main.</description>
    </item>
    
    <item>
      <title>Go æ¯æ—¥ä¸€åº“ä¹‹ Gin</title>
      <link>https://damon-zhangb.github.io/posts/go-%E6%AF%8F%E6%97%A5%E4%B8%80%E5%BA%93%E4%B9%8B-gin/</link>
      <pubDate>Mon, 01 Nov 2021 09:30:18 +0800</pubDate>
      
      <guid>https://damon-zhangb.github.io/posts/go-%E6%AF%8F%E6%97%A5%E4%B8%80%E5%BA%93%E4%B9%8B-gin/</guid>
      <description>1.ç®€ä»‹  Ginæ˜¯ä¸€ä¸ªgolangçš„å¾®æ¡†æ¶ï¼Œå°è£…æ¯”è¾ƒä¼˜é›…ï¼ŒAPIå‹å¥½ï¼Œæºç æ³¨é‡Šæ¯”è¾ƒæ˜ç¡®ï¼Œå…·æœ‰å¿«é€Ÿçµæ´»ï¼Œå®¹é”™æ–¹ä¾¿ç­‰ç‰¹ç‚¹ å¯¹äºgolangè€Œè¨€ï¼Œwebæ¡†æ¶çš„ä¾èµ–è¦è¿œæ¯”Pythonï¼ŒJavaä¹‹ç±»çš„è¦å°ã€‚è‡ªèº«çš„net/httpè¶³å¤Ÿç®€å•ï¼Œæ€§èƒ½ä¹Ÿéå¸¸ä¸é”™ å€ŸåŠ©æ¡†æ¶å¼€å‘ï¼Œä¸ä»…å¯ä»¥çœå»å¾ˆå¤šå¸¸ç”¨çš„å°è£…å¸¦æ¥çš„æ—¶é—´ï¼Œä¹Ÿæœ‰åŠ©äºå›¢é˜Ÿçš„ç¼–ç é£æ ¼å’Œå½¢æˆè§„èŒƒ  hello world package main import ( &amp;quot;net/http&amp;quot; &amp;quot;github.com/gin-gonic/gin&amp;quot; ) func main() { // 1.åˆ›å»ºè·¯ç”± r := gin.Default() // 2.ç»‘å®šè·¯ç”±è§„åˆ™ï¼Œæ‰§è¡Œçš„å‡½æ•° // gin.Contextï¼Œå°è£…äº†requestå’Œresponse r.GET(&amp;quot;/&amp;quot;, func(c *gin.Context) { c.String(http.StatusOK, &amp;quot;hello World!&amp;quot;) }) // 3.ç›‘å¬ç«¯å£ï¼Œé»˜è®¤åœ¨8080 // Run(&amp;quot;é‡Œé¢ä¸æŒ‡å®šç«¯å£å·é»˜è®¤ä¸º8080&amp;quot;) r.Run(&amp;quot;:8000&amp;quot;) }  </description>
    </item>
    
  </channel>
</rss>
